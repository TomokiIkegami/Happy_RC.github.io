<!DOCTYPE html>
<html lang="ja"><head>
  <title>
     Bluetooth モジュールでRCサーボ・ESCを制御したい [第5回-安全性の向上] -  Happy RC Blog !
  </title>
  <meta name="theme-color" content="#a3001b" />
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta name="description" content="ラジコンが楽しくなるような工作やレポートを掲載したいと思います！ラジコン以外にもやってみて苦労したことや、面白かったことについても記録していく予定です！" />
  <meta name="author" content="Tomoki Ikegami" />

  <link rel="stylesheet" href="/Happy_RC.github.io/css/main.css" />
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500&family=Ubuntu+Mono&display=swap" rel="stylesheet">
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css"
  />
</head>
<body>
    
    <header class="regular-page-header shadow round-corner">
  <div
    style="
      display: flex;
      justify-content: space-between;
      width: 98%;
      margin-bottom: 0.5em;
    "
  >
    <a class="primary-icon" href="/Happy_RC.github.io/" aria-label="home page">
      <i class="bi bi-house-fill"></i>
    </a>
    
  </div>
  <div class="page-title-and-info" style="text-align: center">
    <h1 class="page-title" >
      Bluetooth モジュールでRCサーボ・ESCを制御したい [第5回-安全性の向上]
    </h1>
    
    <p class="document-date">
      2022-08-30 &middot; Tomoki Ikegami
    </p>
    
    <p class="document-description">"bluetoothの遅延改善、安全停止機能の追加"</p>
     
  </div>
</header>

    
    <main class="card shadow round-corner">
<h1 id="-目次-----omit-in-toc---">～ 目次 ～ <!-- omit in toc --></h1>
<ul>
<li><a href="#1-%E5%89%8D%E5%9B%9E%E3%81%BE%E3%81%A7%E3%81%AE%E8%AA%B2%E9%A1%8C">1. 前回までの課題</a></li>
<li><a href="#2-%E3%81%AA%E3%81%9C%E9%81%85%E5%BB%B6%E3%81%8C%E8%B5%B7%E3%81%93%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B">2. なぜ遅延が起こったのか</a></li>
<li><a href="#3-%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A9%E3%83%A0%E3%81%AE%E5%86%85%E5%AE%B9">3. フォーラムの内容</a></li>
<li><a href="#4-%E6%94%B9%E8%89%AF%E3%81%AE%E9%81%8E%E7%A8%8B">4. 改良の過程</a>
<ul>
<li><a href="#41--ver5a-esp32%E7%94%A8%E3%81%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%A8%E5%9B%9E%E8%B7%AF%E3%82%92%E5%A4%89%E6%9B%B4">4.1. ◆ ver.5a ～ESP32用にプログラムと回路を変更～</a>
<ul>
<li><a href="#411-%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE">4.1.1. 使ったもの</a></li>
<li><a href="#412-%E4%BD%9C%E3%81%A3%E3%81%9F%E5%9B%9E%E8%B7%AF">4.1.2. 作った回路</a></li>
<li><a href="#413-%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89">4.1.3. ソースコード</a></li>
<li><a href="#414-%E3%82%B9%E3%83%9E%E3%83%9B%E3%82%A2%E3%83%97%E3%83%AA">4.1.4. スマホアプリ</a></li>
</ul>
</li>
<li><a href="#42--ver5b-esp32%E7%94%A8%E3%81%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%A8%E5%9B%9E%E8%B7%AF%E3%82%92%E5%A4%89%E6%9B%B4">4.2. ◆ ver.5b ～ESP32用にプログラムと回路を変更～</a>
<ul>
<li><a href="#421-%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89">4.2.1. ソースコード</a></li>
<li><a href="#422-%E3%82%B9%E3%83%9E%E3%83%9B%E3%82%A2%E3%83%97%E3%83%AA">4.2.2. スマホアプリ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#5-%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB">5. サンプルファイル</a></li>
<li><a href="#6-%E4%BD%BF%E3%81%84%E6%96%B9">6. 使い方</a>
<ul>
<li><a href="#61-%E6%89%8B%E9%A0%86">6.1. 手順</a></li>
<li><a href="#62-%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0">6.2. トラブルシューティング</a></li>
</ul>
</li>
<li><a href="#7-%E8%AC%9D%E8%BE%9E">7. 謝辞</a></li>
<li><a href="#8-%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99">8. 参考資料</a></li>
</ul>
<hr>
<h1 id="1-前回までの課題">1. 前回までの課題</h1>
<p>　<a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/08/20/">前回</a>はRCの操作性を向上させるために色々工夫をしました。</p>
<p>　記事の最後のほうでは、bluetooth通信に謎の遅延が発生する問題について触れました。</p>
<p>　まずは、この問題について調べた内容や解決策について書きます！</p>
<h1 id="2-なぜ遅延が起こったのか">2. なぜ遅延が起こったのか</h1>
<p>　今私の試している装置（bluetoothモジュール）では、「2秒間送受信→2秒間お休み→2秒間送受信→…（繰り返し）」という謎の動きをします。</p>
<p>　Arduinoのフォーラム<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>でも同じような悩みを抱えている人がいたので、問題解決の参考に読んでみました。　</p>
<h1 id="3-フォーラムの内容">3. フォーラムの内容</h1>
<p>　HC-05には動作状態を表す赤色のLEDがついています。質問者はLEDが点灯していない時間を&quot;wating period&quot;と呼んで問題を説明しています。</p>
<p>　質問者の投稿によれば、&ldquo;wating period&quot;の間は遅延が無いと言っています。実際私も同じ状況で、LEDが点灯していない（&ldquo;wating period&rdquo;）の間はスマホのボタンを押したらすぐにRCが反応します。</p>
<p>　逆にLEDが点滅している(2秒間くらい)はスマホアプリを操作しても全く反応しませんでした。これも質問者と全く同じ挙動です。</p>
<p>　フォーラムの中では色々な原因が述べられていたので、その中のいくつかを箇条書きでまとめます。</p>
<ul>
<li>送信側のソフトに問題がある</li>
<li>同じシリアルポートでHC-05とシリアルモニターを動かしている</li>
<li>HC-05がATコマンドモード(※)に入っている</li>
<li>HC-05に入力している電圧が間違えている</li>
<li>RXとTXを逆につないでいる</li>
<li>HC-05に欠陥がある</li>
</ul>
<blockquote>
<p>※ATコマンド：AT▲▲という形式（▲▲のところにはアルファベット・記号・数字が入る。文字数は色々）で命令を送る通信方法のようです。例えば、ATAならコマンド強制着信、ATEnならコマンドエコーなどの命令になる<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>みたいです。</p>
</blockquote>
<p>　初めからHC-05が壊れていると考えたくなかったので、上の項目から順番に確認していきました。でも結局、私の買ったHC-05に欠陥が問題があることが判明しました。（1個1000円もしなくて安かった無理もないかぁ&hellip;）</p>
<p>　フォーラムの質問者もモジュールを交換してちゃんと動いたと言っていました。</p>
<p>　私はESP32を使って、HC-05のときと同じ条件で実験したらちゃんと動きました。</p>
<h1 id="4-改良の過程">4. 改良の過程</h1>
<p>　この記事のタイトルは ”bluetoothモジュールで&hellip;&rdquo; となっていますが、今回からは<strong>ESP32</strong>を使ってBluetooth接続をします。</p>
<p>　ESP32は技適マークがついているので、日本でも安心して実験ができます。ESP32は色々なモデルがあるのですが、<strong>ESP32-WROOM-32E</strong> を使って実験をしました。</p>
<p>　以下では改良過程を記載しましたが、すぐに動かしてみたいという方は<a href="#411-%E4%BD%BF%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE">4.1.1項</a>で使う装置を確認したあと、<a href="#61-%E6%89%8B%E9%A0%86">6.1節</a>を見ながら作業やってみてください。</p>
<h2 id="41--ver5a-esp32用にプログラムと回路を変更">4.1. ◆ ver.5a ～ESP32用にプログラムと回路を変更～　</h2>
<h3 id="411-使ったもの">4.1.1. 使ったもの</h3>
<p>　今回の実験で使ったハードウェアをリストアップしておきます。<a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/03/15/">第3回</a>とは異なり、マイコンには<strong>ESP32</strong>を使用しました。操作に使ったアプリは後ほど紹介します。</p>
<ol>
<li><strong>ラジコンカー</strong>本体：ECX Barrage 1.9（1/12スケール） ←<strong>1/10スケール</strong>のRCがオススメ</li>
<li>操縦用<strong>スマホ</strong>（送信機）：Moto g pro（<strong>Android</strong> 12）</li>
<li>マイコン（受信機）：<strong>ESP32-WROOM-32</strong>E</li>
<li><strong>モバイルバッテリー</strong>：SANYO KBC-L54D (3.7V Li-ion 5400mAh ※INPUT,OUTPUT=5.0V)</li>
<li>走行用バッテリー：Dynamite Speedpack (<strong>7.2V Ni-MH</strong> 700mAh)←<strong>7.4v Li-Po</strong> でも可</li>
<li><strong>サーボモータ</strong>：Hitec DB777WP ←<strong>1/10スケールカー用</strong></li>
<li>走行用モータ：Tazer 370 Motor （DYNS1209）←<strong>1/10スケールRC</strong>だと<strong>540モータ</strong>多いと思います</li>
<li><strong>クローラ用ESC</strong>：TEKIN BXR（クローララジコン用ESC）</li>
</ol>
<p>　必ずしも上の装置でないと動かないわけではないので安心してください。自分の持っている装置に合わせて自由に組み合わせて良いです。（上の項目で<strong>太字</strong>になっているキーワードが重要です！）</p>
<p>　ラジコンカーのキットとRC装置をそろえるのが大変という方は、組み立て済みのRCカーを買うのがオススメです。（上の1,5,6,7,8のものが一気に揃います。注意：項目8のESCはクローラ用ではない可能性が高いです）　</p>
<p>　<strong>ESC</strong>に関しては<strong>クローララジコン用</strong>のものを推奨します（アプリをドラグブレーキがあるとして設計にしています）。クローラ用ESCには<strong>ドラグブレーキ</strong><sup>※</sup>がついているので便利です。</p>
<blockquote>
<p>※ドラグブレーキ<br>
　スロットルを操作していないときに、<strong>自動的にブレーキがかかる</strong>機能です。この機能のおかげで、斜面に車体をおいても勝手に下がっていくのを防いでくれます。</p>
</blockquote>
<h3 id="412-作った回路">4.1.2. 作った回路</h3>
<p>　回路は下のようになります。ESCはマイナス極と信号線（PWMピン）しか配線しないので注意してください。（<strong>プラス極には配線しないこと</strong>）</p>
<p>　また、回路図上ではモバイルバッテリーに結線されていますが、実際に接続するときはモバイルバッテリーとESP32をUSBケーブルで接続すれば大丈夫です。</p>
  <div align="center">
  <figure><img src="rc_control_using_esp32_bluetooth_no_BEC.svg"
         alt="サーボモータ＆ESC制御用回路"/>
</figure>

  </div>
  <div style="text-align: center;">
  ☝　サーボモータ＆ESC制御用回路
  </div>
<h3 id="413-ソースコード">4.1.3. ソースコード</h3>
<p>　こちらがArduinoマイコンに書き込んだソースコードです。これはver.4と同じで文字を送信してステアとスロットルを操作します。</p>
<p>　下の図はそれぞれの記号（A~I）と、それに対応する動作（前後左右にどう動くか）を整理したものです。（図は<a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/08/20/">前回</a>と同じ）</p>
  <div align="center">
  <figure><img src="%e3%83%95%e3%83%ab%e3%83%95%e3%82%a1%e3%83%b3%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e5%85%a8%e3%83%91%e3%82%bf%e3%83%bc%e3%83%b3.svg"
         alt="考えられる全動作パターン"/>
</figure>

  </div>
  <div style="text-align: center;">
  ☝　考えられる全動作パターン
  </div>
  <br>
  <div style="text-align: center;">
⇩⇩⇩ ソースコード ⇩⇩⇩
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#960050;background-color:#1e0010">#</span>include <span style="color:#e6db74">&#34;BluetoothSerial.h&#34;</span> <span style="color:#75715e">//ESP32のBluetooth通信に使用
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">#</span>include <span style="color:#f92672">&lt;</span>Servo<span style="color:#f92672">.</span><span style="color:#a6e22e">h</span><span style="color:#f92672">&gt;</span>　<span style="color:#75715e">//サーボモータの制御に使用
</span><span style="color:#75715e"></span>
Servo myservo<span style="color:#f92672">;</span>    <span style="color:#75715e">// サーボモータを制御するためのServoオブジェクト作成
</span><span style="color:#75715e"></span>Servo myesc<span style="color:#f92672">;</span>    <span style="color:#75715e">// ESCを制御するためのServoオブジェクト作成
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/* ステアリングの設定 */</span>
<span style="color:#66d9ef">int</span> center_pos <span style="color:#f92672">=</span> 93<span style="color:#f92672">;</span> <span style="color:#75715e">//ステア中心位置 [サーボモータの中心位置 (90°)]　★まっすぐ走るように調整
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> left_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//左の切れ角
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> right_DR <span style="color:#f92672">=</span> 25<span style="color:#f92672">;</span> <span style="color:#75715e">//右の切れ角
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> left_max <span style="color:#f92672">=</span> center_pos <span style="color:#f92672">-</span> left_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//左ステアの最大位置 [中心位置より反時計回りに20°（left_DR）回転した位置]
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> right_max <span style="color:#f92672">=</span> center_pos <span style="color:#f92672">+</span> right_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//右ステアの最大位置 [中心位置より時計回りに25°（right_DR）回転した位置]
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/* スロットルの設定 */</span>
<span style="color:#66d9ef">int</span> neutral_pos <span style="color:#f92672">=</span> 91<span style="color:#f92672">;</span> <span style="color:#75715e">//中立位置 [スロットルの中立位置 (90) ※ESCの設定によってずれがあるので、前後に走行しないよう値を調整する。ESC側を90で中立になるよう設定してもよい。]
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> forward_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//前進の速さ
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> backward_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//バックの速さ
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> forward_max <span style="color:#f92672">=</span> neutral_pos <span style="color:#f92672">+</span> forward_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//前進の最大位置
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> backward_max <span style="color:#f92672">=</span> neutral_pos <span style="color:#f92672">-</span> backward_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//バックの最大位置
</span><span style="color:#75715e"></span>

<span style="color:#75715e">//速度(mov_speed_ST,mov_speed_TH)は 1~255 の範囲で与える。（0にすると最大速度で移動）
</span><span style="color:#75715e">//スロットル、サーボモータの値(pos)の範囲は、 0≦ pos ≦180 で与える。
</span><span style="color:#75715e">//myservo.write 関数には回転角を絶対的な位置で与える。例) 90°から 45°反時計回りに動いてほしいときは、-45ではなく、45を関数に入力する。
</span><span style="color:#75715e"></span>
BluetoothSerial ESP_BT<span style="color:#f92672">;</span> <span style="color:#75715e">//ESP_BTという名前でオブジェクトを定義
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">begin</span><span style="color:#f92672">(</span>115200<span style="color:#f92672">);</span> <span style="color:#75715e">//シリアルモニタで確認用
</span><span style="color:#75715e"></span>  ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">begin</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ESP32_RC_Receiver&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">//接続画面で表示される名前を設定
</span><span style="color:#75715e"></span>  myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">attach</span><span style="color:#f92672">(</span>4<span style="color:#f92672">);</span> <span style="color:#75715e">//サーボモータのPWM端子とArduinoの9番ピンを接続
</span><span style="color:#75715e"></span>  myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">attach</span><span style="color:#f92672">(</span>16<span style="color:#f92672">);</span> <span style="color:#75715e">//ESCのPWM端子とArduinoの6番ピンを接続
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*勝手には走りださないように設定*/</span>
  myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>  myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">available</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">char</span> input <span style="color:#f92672">=</span> ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span> <span style="color:#75715e">//受信したテキストを変数inputに保存
</span><span style="color:#75715e"></span>    Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>input<span style="color:#f92672">);</span> <span style="color:#75715e">//受信したテキストをシリアルモニタに表示
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;B&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;C&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;D&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;E&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;F&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;G&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;H&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;I&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span><span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>
      myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>      myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span>

  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
<blockquote>
<p>　ESP32では、VarSpeedServo.hライブラリが使えないみたい<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>でした。なので現状では動きが急でカクカクです（笑）<br>
　PWM制御を本格的に実装しても良いですが、今はServo.hライブラリで滑らかに制御をする方法を検討中です。<br></p>
</blockquote>
<h3 id="414-スマホアプリ">4.1.4. スマホアプリ</h3>
<p>　下の画像（2枚）が試作したアプリの外観と中身になります。中身はver.4とほとんど同じですが、ver.5aでは次の点をアップデートしました。</p>
<ul>
<li>
<p>接続状態の表示方法を改善</p>
</li>
<li>
<p>画面の回転を縦に固定</p>
</li>
<li>
<p>スマホを振るあるいはバックボタンを押すと車体を停止</p>
<div align="center">
<figure><img src="UI5a.png"
         alt="アプリ外観（デザイン編集タブ）"/>
</figure>

</div>
<div style="text-align: center;">
☝　アプリ外観（デザイン編集タブ）
</div>
<div align="center">
<figure><img src="blocks5a.png"
         alt="アプリの中身（ブロック編集タブ）"/>
</figure>

</div>
<div style="text-align: center;">
☝　アプリの中身（ブロック編集タブ）
</div>
</li>
</ul>
<p>　MIT App Inventorの細かい操作方法は<a href="https://appinventor.tmsoftwareinc.com/tutorials">MIT App Inventor 2 日本語化プロジェクトのチュートリアル</a>が参考になると思います。</p>
<h2 id="42--ver5b-esp32用にプログラムと回路を変更">4.2. ◆ ver.5b ～ESP32用にプログラムと回路を変更～　</h2>
<p>　使ったものと回路はver.5aと全く同じになります。ver.5bでは次の点をアップデートしました。</p>
<ul>
<li>アプリが閉じたとき（あるいはバックグラウンドに入ったとき）に車体を停止（安全のため）</li>
<li>アプリ中央のPボタンを押したときにバイブ（操作性向上の目的）</li>
<li>アプリ再起動時にはPボタンを押さないと走行しないように設計（アプリを開いたときに前の命令が残っていて、急発進することがあったため）</li>
</ul>
<h3 id="421-ソースコード">4.2.1. ソースコード</h3>
<p>　Arduino IDEから、ESP32に書き込んで使用します。</p>
<p>　ver.5aと異なり、ver.5bでは安全停止のための処理を追加しました。安全停止には、<strong>タイマー割り込み</strong>という機能を使っています。</p>
<p>　タイマー割り込みのソースコードは、田中正幸氏のブログ記事<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>で紹介されてたものを利用させていただきました。</p>
<p>　プログラムの詳細な説明は、コメント文に書いたのでご覧ください。</p>
<p><br>  <div style="text-align: center;">
⇩⇩⇩ ソースコード ⇩⇩⇩</p>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/* Happy_RC_Receiver(version 5b) *****************************
</span><span style="color:#75715e">  Download a Transmitter App:https://github.com/TomokiIkegami/Happy_RC_Driver/raw/main/Happy_RC_Driver.apk
</span><span style="color:#75715e">  About this Project:https://github.com/TomokiIkegami/Happy_RC_Driver
</span><span style="color:#75715e">
</span><span style="color:#75715e">  ◆ 動作
</span><span style="color:#75715e">  1.スマホアプリ(Happy_RC_Receiver)から命令（&#39;A&#39;～&#39;I&#39;）を取得
</span><span style="color:#75715e">  2.取得した命令に基づいて、RCを前後左右に操作
</span><span style="color:#75715e">  ◆ 機能
</span><span style="color:#75715e">  ・アプリを開いていないときは、車体を停止させる安全機能を装備（Dragブレーキ付きESCを使用すること）
</span><span style="color:#75715e">  ・アプリ再起動時には、走行停止ボタン（画面中央のPボタン）を押さないと走行しない（アプリ再起動時に急に走行する危険を防ぐため）
</span><span style="color:#75715e">
</span><span style="color:#75715e">  ◆ 補足
</span><span style="color:#75715e">  ・プログラム中で★マークがついている部分は、自分の装置に合わせて調整してください。
</span><span style="color:#75715e">*************************************************************/</span>

<span style="color:#75715e">/*ハードウェアの接続ピンの設定*/</span>
<span style="color:#960050;background-color:#1e0010">#</span>define LED_PIN 2 <span style="color:#75715e">//走行には無関係。2番ピンにLEDのアノード(+)を接続すると割り込み処理の間隔(100ms)でLEDが点滅
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">#</span>define LED_PIN_ACTIVE 17 <span style="color:#75715e">//走行には無関係。17番ピンにLEDのアノード(+)を接続すると、アプリ起動時のみLEDが点灯
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">#</span>define SERVO_PWM_PIN 4 <span style="color:#75715e">//サーボモータのPWMピン（信号入力ピン）をESP32の4番ピンに接続 ★回路と対応した番号にする
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">#</span>define ESC_PWM_PIN 16 <span style="color:#75715e">//ESCのPWMピン（信号入力ピン）をESP32の16番ピンに接続 ★回路と対応した番号にする
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*タイマーの定義*/</span>
hw_timer_t<span style="color:#f92672">*</span>timer <span style="color:#f92672">=</span> NULL<span style="color:#f92672">;</span>

<span style="color:#75715e">/*ライブラリ*/</span>
<span style="color:#960050;background-color:#1e0010">#</span>include <span style="color:#e6db74">&#34;BluetoothSerial.h&#34;</span> <span style="color:#75715e">//ESP32のBluetooth通信に使用
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">#</span>include <span style="color:#f92672">&lt;</span>Servo<span style="color:#f92672">.</span><span style="color:#a6e22e">h</span><span style="color:#f92672">&gt;</span>　<span style="color:#75715e">//サーボモータの制御に使用
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*ESC,サーボのオブジェクト作成*/</span>
Servo myservo<span style="color:#f92672">;</span>    <span style="color:#75715e">// サーボモータを制御するためのServoオブジェクト作成
</span><span style="color:#75715e"></span>Servo myesc<span style="color:#f92672">;</span>    <span style="color:#75715e">// ESCを制御するためのServoオブジェクト作成
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/* ステアリングの設定 */</span>
<span style="color:#66d9ef">int</span> center_pos <span style="color:#f92672">=</span> 93<span style="color:#f92672">;</span> <span style="color:#75715e">//ステア中心位置 [サーボモータの中心位置 (90°)]　★まっすぐ走るように調整。90より大きい値にするとステア（ハンドル）が右寄りに、90より小さい値にするとステア（ハンドル）が左寄りになる
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> left_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//左の切れ角 ★:好みに合わせて調整。ただし大きくしすぎないように注意。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> right_DR <span style="color:#f92672">=</span> 25<span style="color:#f92672">;</span> <span style="color:#75715e">//右の切れ角 ★:好みに合わせて調整。ただし大きくしすぎないように注意。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> left_max <span style="color:#f92672">=</span> center_pos <span style="color:#f92672">-</span> left_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//左ステアの最大位置 [中心位置より反時計回りに20°（left_DR）回転した位置] ★逆に動くときはleft_DRの手前の符号をプラス（+）に
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> right_max <span style="color:#f92672">=</span> center_pos <span style="color:#f92672">+</span> right_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//右ステアの最大位置 [中心位置より時計回りに25°（right_DR）回転した位置] ★逆に動くときはright_DRの手前の符号をマイナス（-）に
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/* スロットルの設定 */</span>
<span style="color:#66d9ef">int</span> neutral_pos <span style="color:#f92672">=</span> 91<span style="color:#f92672">;</span> <span style="color:#75715e">//中立位置 [スロットルの中立位置 (90) ★ESCの設定によってずれがあるので、前後に走行しないよう値を調整する。※ ESC側を90で中立になるよう設定（上級者向け。ESCの説明書通りプロポでニュートラル設定を済ませてから、このプログラムの値を調整するのがオススメ）してもよい。]
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> forward_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//前進の速さ ★好みの速度に調整
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> backward_DR <span style="color:#f92672">=</span> 20<span style="color:#f92672">;</span> <span style="color:#75715e">//バックの速さ ★好みの速度に調整
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> forward_max <span style="color:#f92672">=</span> neutral_pos <span style="color:#f92672">+</span> forward_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//前進の最大位置 ★逆に動くときはforward_DRの手前の符号をマイナス（-）に
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> backward_max <span style="color:#f92672">=</span> neutral_pos <span style="color:#f92672">-</span> backward_DR<span style="color:#f92672">;</span> <span style="color:#75715e">//バックの最大位置 ★逆に動くときはbackward_DRの手前の符号をプラス（+）に
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*プログラムの流れを制御する変数*/</span>
<span style="color:#66d9ef">int</span> flag <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> <span style="color:#75715e">//アプリの起動状態を管理する変数。アプリがバックグラウンドに入ったときは1に設定する。アプリがバックグラウンドから復帰し、アプリのPボタンが押されたら0に設定してラジコン操作を有効にする。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">char</span> input <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C&#39;</span><span style="color:#f92672">;</span> <span style="color:#75715e">//入力信号
</span><span style="color:#75715e"></span>unsigned <span style="color:#66d9ef">long</span> t1 <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> <span style="color:#75715e">//データ受信時間
</span><span style="color:#75715e"></span>unsigned <span style="color:#66d9ef">long</span> t2 <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> <span style="color:#75715e">//割り込み時の時間
</span><span style="color:#75715e"></span>unsigned <span style="color:#66d9ef">long</span> td <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> <span style="color:#75715e">//データ受信時間と割り込み時間の差
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//スロットル、サーボモータの値(pos)の範囲は、 0≦ pos ≦180 で与える。
</span><span style="color:#75715e">//myservo.write 関数には回転角を絶対的な位置で与える。例) 90°から 45°反時計回りに動いてほしいときは、-45ではなく、45を関数に入力する。
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*Bluetooth通信に必要*/</span>
BluetoothSerial ESP_BT<span style="color:#f92672">;</span> <span style="color:#75715e">//ESP_BTという名前でオブジェクトを定義
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*割り込み関数onTimerで実行される内容*/</span>
<span style="color:#66d9ef">void</span> IRAM_ATTR <span style="color:#a6e22e">onTimer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  digitalWrite<span style="color:#f92672">(</span>LED_PIN<span style="color:#f92672">,</span> <span style="color:#f92672">!</span>digitalRead<span style="color:#f92672">(</span>LED_PIN<span style="color:#f92672">));</span> <span style="color:#75715e">//前の出力と反転して点灯（チカチカする）
</span><span style="color:#75715e"></span>  t2 <span style="color:#f92672">=</span> millis<span style="color:#f92672">();</span>  <span style="color:#75715e">//割り込み時の時間を測定（100ms間隔）
</span><span style="color:#75715e"></span>  td <span style="color:#f92672">=</span> t2 <span style="color:#f92672">-</span> t1<span style="color:#f92672">;</span> <span style="color:#75715e">//割り込み時の時間と命令取得時間の差を取る。この差が大きいとき、アプリは起動していない状態。
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  pinMode<span style="color:#f92672">(</span>LED_PIN_ACTIVE<span style="color:#f92672">,</span> OUTPUT<span style="color:#f92672">);</span> <span style="color:#75715e">//LEDの点灯ピンを出力用に設定
</span><span style="color:#75715e"></span>  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">begin</span><span style="color:#f92672">(</span>115200<span style="color:#f92672">);</span> <span style="color:#75715e">//シリアルモニタで確認用
</span><span style="color:#75715e"></span>  ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">begin</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ESP32_RC_Receiver&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">//接続画面で表示される名前を設定 ★好きな名前にしてよい
</span><span style="color:#75715e"></span>  myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">attach</span><span style="color:#f92672">(</span>SERVO_PWM_PIN<span style="color:#f92672">);</span> <span style="color:#75715e">//サーボモータのPWM端子とArduinoの4番ピンを接続 ★回路と対応した番号にする
</span><span style="color:#75715e"></span>  myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">attach</span><span style="color:#f92672">(</span>ESC_PWM_PIN<span style="color:#f92672">);</span> <span style="color:#75715e">//ESCのPWM端子とArduinoの16番ピンを接続 ★回路と対応した番号にする
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">/*勝手には走りださないように設定*/</span>
  myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>  myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">/*割り込み処理（アプリ停止の検知に必要）の設定*/</span>
  pinMode<span style="color:#f92672">(</span>LED_PIN<span style="color:#f92672">,</span> OUTPUT<span style="color:#f92672">);</span> <span style="color:#75715e">//LEDの点灯ピンを出力用に設定
</span><span style="color:#75715e"></span>  timer <span style="color:#f92672">=</span> timerBegin<span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 80<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">//80クロック1カウント
</span><span style="color:#75715e"></span>  timerAttachInterrupt<span style="color:#f92672">(</span>timer<span style="color:#f92672">,</span> <span style="color:#f92672">&amp;</span>onTimer<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">//onTimerという名前の関数で割り込み
</span><span style="color:#75715e"></span>  timerAlarmWrite<span style="color:#f92672">(</span>timer<span style="color:#f92672">,</span> 1000000 <span style="color:#f92672">*</span> 0<span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span> <span style="color:#75715e">//80クロック×1000000カウント=1秒、1*0.1=100[ms]
</span><span style="color:#75715e"></span>  timerAlarmEnable<span style="color:#f92672">(</span>timer<span style="color:#f92672">);</span> <span style="color:#75715e">//タイマー有効化
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loop</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>

  <span style="color:#75715e">/*available()で受信した信号があるか確認*/</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">available</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
    t1 <span style="color:#f92672">=</span> millis<span style="color:#f92672">();</span> <span style="color:#75715e">//データを取得した時間を記録
</span><span style="color:#75715e"></span>    input <span style="color:#f92672">=</span> ESP_BT<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span> <span style="color:#75715e">//受信したテキストを変数inputに保存
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//Serial.println(input); //受信したテキストをシリアルモニタに表示
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">/*Pボタンが押されたらラジコンの操作を有効する（安全のため）*/</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>flag <span style="color:#f92672">==</span> 1 <span style="color:#f92672">&amp;&amp;</span> input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;C&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      flag <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#75715e">/*アプリ起動時（flag=0のとき）は操作を有効にする*/</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>flag <span style="color:#f92672">==</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

      <span style="color:#75715e">/*命令に基づいてラジコンを制御*/</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;B&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;C&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;D&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;E&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;F&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;G&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>forward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//前進(Forward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;H&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>left_max<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを左(Left)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>input <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;I&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>right_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//ステアを右(Right)に切る
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>backward_max<span style="color:#f92672">);</span>  <span style="color:#75715e">//後退(Backward)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
        myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>        myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/*シリアルモニタで確認用（ラジコンの制御には無関係）*/</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Received signal=&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>input<span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;t1=&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>t1<span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;t2=&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>t2<span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;t2-t1=&#34;</span><span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>td<span style="color:#f92672">);</span>
  Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">);</span>

  <span style="color:#75715e">/*アプリがバックグラウンドに入ったとき（もしくは閉じたとき）、車体を停止させる処理（安全のため）*/</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>td <span style="color:#f92672">&gt;</span> 150<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Transmitter is NOT active&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">//NOT active：アプリはバックグラウンド状態（もしく閉じている）
</span><span style="color:#75715e"></span>    Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">);</span>
    myservo<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>center_pos<span style="color:#f92672">);</span> <span style="color:#75715e">// ステアを中心(Center)に
</span><span style="color:#75715e"></span>    myesc<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>neutral_pos<span style="color:#f92672">);</span>  <span style="color:#75715e">//中立(Neutral)
</span><span style="color:#75715e"></span>    input <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">;</span>
    digitalWrite<span style="color:#f92672">(</span>LED_PIN_ACTIVE<span style="color:#f92672">,</span> LOW<span style="color:#f92672">);</span> <span style="color:#75715e">//アプリがバックグラウンドに入ったとき（もしくは閉じたとき）はLEDを消灯
</span><span style="color:#75715e"></span>    flag <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span> <span style="color:#75715e">//アプリがバックグラウンド状態に入った（もしく閉じた）ときはflag=1に設定
</span><span style="color:#75715e"></span>  <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
    Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Transmitter is active&#34;</span><span style="color:#f92672">);</span> <span style="color:#75715e">//active：アプリの画面が開いている
</span><span style="color:#75715e"></span>    Serial<span style="color:#f92672">.</span><span style="color:#a6e22e">print</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">);</span>
    digitalWrite<span style="color:#f92672">(</span>LED_PIN_ACTIVE<span style="color:#f92672">,</span> HIGH<span style="color:#f92672">);</span> <span style="color:#75715e">//アプリ起動時（画面を開いているとき）にはLEDを点灯
</span><span style="color:#75715e"></span>  <span style="color:#f92672">}</span>


<span style="color:#f92672">}</span></code></pre></div>
<h3 id="422-スマホアプリ">4.2.2. スマホアプリ</h3>
<p>　下の画像（2枚）が試作したアプリの外観と中身になります。ver.5bでは次の点をアップデートしました。</p>
<ul>
<li>
<p>接続状態の表示方法を改善</p>
</li>
<li>
<p>命令送信用のタイマー追加</p>
</li>
<li>
<p>中央の車体停止の信号が送信されるとバイブ</p>
<div align="center">
<figure><img src="UI5b.png"
         alt="アプリ外観（デザイン編集タブ）"/>
</figure>

</div>
<div style="text-align: center;">
☝　アプリ外観（デザイン編集タブ）
</div>
<div align="center">
<figure><img src="blocks5b.png"
         alt="アプリの中身（ブロック編集タブ）"/>
</figure>

</div>
<div style="text-align: center;">
☝　アプリの中身（ブロック編集タブ）
</div>
</li>
</ul>
<h1 id="5-サンプルファイル">5. サンプルファイル</h1>
<p>　作成したアプリのデータはこちらになります。改良して愛車に搭載するなど自由に楽しんでください！</p>
<p><strong>～ MIT App Inventorプロジェクトのファイル(.aia) ～</strong></p>
<ul>
<li><a href="Happy_RC_Driver_5a.aia">Happy_RC_Driver_5a.aia</a></li>
<li><a href="Happy_RC_Driver_5b.aia">Happy_RC_Driver_5b.aia</a></li>
</ul>
<p><strong>～ Androidアプリのファイル(.apk) ～</strong></p>
<ul>
<li><a href="Happy_RC_Driver_5a.apk">Happy_RC_Driver_5a.apk</a></li>
<li><a href="Happy_RC_Driver_5b.apk">Happy_RC_Driver_5b.apk</a></li>
</ul>
<h1 id="6-使い方">6. 使い方</h1>
<p>　初めに実験をするときは、車輪を浮かせた状態で行ってください。調整できたら実際に地面において走行させてみましょう！</p>
<h2 id="61-手順">6.1. 手順</h2>
<ol>
<li>ESP32に[<a href="#421-%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89">4.2.1項</a>のソースコードを書き込みます。（Arduino IDEなどを使用。ESP32のセットアップは<a href="http://microtechnica.xyz/?p=271">こちら</a>が参考になります）</li>
<li>回路を<a href="#412-%E4%BD%9C%E3%81%A3%E3%81%9F%E5%9B%9E%E8%B7%AF">4.1.2項</a>のように組み立てます。（ブレッドボードやジャンパ線などで配線）</li>
<li>まずESP32の電源をONにします。（モバイルバッテリーの電源をONにすればよい）</li>
<li>次にESCの電源をONにします。</li>
<li>スマホの設定画面の接続設定から”ESP32_RC_Receiver”をペアとして設定します。</li>
<li><a href="Happy_RC_Driver_5b.apk">Happy_RC_Driver_5b.apk</a>をスマホ（Android）にダウンロードし、インストールします。</li>
<li>スマホアプリ（Happy_RC_Driver_5b）を開きます。</li>
<li>アプリ上で「ここをタップしてRCに接続」ボタンを押します。</li>
<li>表示されるリストの中から”ESP32_RC_Receiver”を選びます。</li>
<li>アプリ上部の表示が”RCに接続済み（運転再開時：まずPボタンを押す）”と緑色で表示されたらOKです。</li>
<li>この状態でアプリのボタンを押してみてください。RCが走行すると思います。</li>
<li>まっすぐ走行するように<a href="#421-%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89">Arduinoプログラム</a>の /* ステアリングの設定 */ にあるcenter_posの値を調整してください。</li>
<li>次に、左右の切れ角（left_DR,right_DR）も調整してください。※切れ角は大きくしすぎると、ESP32やサーボモータ、ラジコンカーを壊す恐れがあるので注意してください。</li>
<li>車体を止めるときはアプリ中央のPボタンを押すか、スマホを振ります。</li>
</ol>
<h2 id="62-トラブルシューティング">6.2. トラブルシューティング</h2>
<p>　手順通りやっても上手く動かない場合、以下の点が考えられます。</p>
<table>
<thead>
<tr>
<th>起こっている問題</th>
<th>原因</th>
<th>対処</th>
</tr>
</thead>
<tbody>
<tr>
<td>ESCが起動しない</td>
<td>a.電源が入っていない<br> b.スロットルの中立位置がずれている</td>
<td>a.バッテリーのコネクタを接続してスイッチをONに <br>b.Arduinoプログラムの/* スロットルの設定 */のneurtal_posの値を調整してください。それでも上手くいかない場合は、ESCの説明書に従ってニュートラル位置の修正を行ってください。</td>
</tr>
<tr>
<td>勝手に走り出す</td>
<td>スロットルの中立位置がずれている</td>
<td>/* スロットルの設定 */のneurtal_posの値を調整してください。</td>
</tr>
<tr>
<td>バックしない</td>
<td>車体が停止していない</td>
<td>Pボタンを押してからバックしてみてください</td>
</tr>
<tr>
<td>片側の切れ角が大きくならない</td>
<td>組み立て時に、サーボのニュートラル（90°）から大きくずれた位置でサーボホーンを固定している</td>
<td>サーボホーンを一度取り外して、neurtal_pos=90°の状態でハンドルがなるべく中心になるよう組み立ててください</td>
</tr>
</tbody>
</table>
<h1 id="7-謝辞">7. 謝辞</h1>
<p>　安全停止処理の実装にあたり、Toma Takei氏にアドバイスを頂きました。心より感謝申し上げます。</p>
<h1 id="8-参考資料">8. 参考資料</h1>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Arduino FORUM「Bluetooth HC-05 command delay」、(<a href="https://forum.arduino.cc/t/bluetooth-hc-05-command-delay/916823">https://forum.arduino.cc/t/bluetooth-hc-05-command-delay/916823</a>)&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>OMRON「ATコマンドの基本」、(<a href="https://socialsolution.omron.com/jp/ja/products_service/ups/discontinued/me5614u2/me5614u2.pdf">https://socialsolution.omron.com/jp/ja/products_service/ups/discontinued/me5614u2/me5614u2.pdf</a>)&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>Twitter、(<a href="https://twitter.com/mongonta555/status/1422865227113144323">https://twitter.com/mongonta555/status/1422865227113144323</a>)&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>Lang-ship「ESP32の高精度タイマー割り込みを調べる」、(<a href="https://lang-ship.com/blog/work/esp32-timer/">https://lang-ship.com/blog/work/esp32-timer/</a>)&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>


    </main><footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: { equationNumbers: {autoNumber: "AMS"} },
      tex2jax: {
        inlineMath: [['$','$']]
      }
    });
  </script>
  
  
  
  
  <div class="prev-next">
    <a
      class="active icon"
      href="/Happy_RC.github.io/2022/08/20/"
      aria-label="Previous Article"
      ><i class="bi bi-arrow-left-circle-fill"></i
    ></a>
    <a
      class="active icon"
      href="/Happy_RC.github.io/2022/09/12/"
      aria-label="Next Article"
      ><i class="bi bi-arrow-right-circle-fill"></i
    ></a>
  </div>
  </div>
  
  <div class="footer shadow round-corner">
    
    <div class="grid-container">
      <div class="footer-recent-posts">
        <h6>Recent Posts</h6>
        <ol>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/11/06/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第9回-外出先でもプログラムを編集したい]</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/10/09/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第8回-ターボ機能を追加]</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/09/29/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第7回-回路をシンプル＆コンパクトに]</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/09/27/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第6回-動きを滑らかに]</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/09/12/">GS02のタイヤを浮かせたい！</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/08/30/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第5回-安全性の向上]</a></li>
          
          <li><a href="https://tomokiikegami.github.io/Happy_RC.github.io/2022/08/20/">Bluetooth モジュールでRCサーボ・ESCを制御したい [第4回-操作性の向上]</a></li>
          
        </ol>
        <a href="/Happy_RC.github.io/archive">...ALL POSTS</a>
        <hr class="mobile white-hr" />
      </div>
      <div>
        <h6>Sections</h6>
<div class="section-container">
  
  
  <a class="section" href="https://tomokiikegami.github.io/Happy_RC.github.io/post/" aria-label="site sections"
    >Posts</a
  >
  
  
  
  
  
  
</div>

        









<h6>
  Tags
</h6>

<div class="taxa-container">
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/arduino/">Arduino</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E3%82%B5%E3%83%BC%E3%83%9C/">サーボ</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E7%84%A1%E7%B7%9A%E9%80%9A%E4%BF%A1/">無線通信</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/esc/">ESC</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/freecad/">FreeCAD</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/mit-app-inventor/">MIT App Inventor</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E8%87%AA%E4%BD%9C%E3%82%A2%E3%83%97%E3%83%AA/">自作アプリ</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/3d%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0/">3Dモデリング</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E6%A9%9F%E6%A2%B0%E8%A8%AD%E8%A8%88/">機械設計</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/3d%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF/">3Dプリンタ</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E3%82%AE%E3%82%A2/">ギア</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/ultimaker-cura/">Ultimaker Cura</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/arduinodroid/">ArduinoDroid</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/html%E3%82%BF%E3%82%B0/">htmlタグ</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/hugo/">hugo</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/libreoffice-draw/">LibreOffice Draw</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/word/">Word</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E3%83%9C%E3%83%87%E3%82%A3%E5%A1%97%E8%A3%85/">ボディ塗装</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E5%9B%B3%E3%81%AE%E4%BD%9C%E6%88%90/">図の作成</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/tags/%E6%96%87%E5%AD%97%E8%A3%85%E9%A3%BE/">文字装飾</a>
  
</div>


<h6>
  Categories
</h6>

<div class="taxa-container">
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/categories/%E3%83%A9%E3%82%B8%E3%82%B3%E3%83%B3/">ラジコン</a>
  
  
    <a class="taxa" href="https://tomokiikegami.github.io/Happy_RC.github.io/categories/%E5%82%99%E5%BF%98%E9%8C%B2/">備忘録</a>
  
</div>


        <hr class="mobile white-hr" />
      </div>
    </div>
    
    <div class="footer-info-text">
      <p>
        
        <span>2022</span>
        <span>Tomoki Ikegami.</span>
        <span>I hope to enjoy your RC Life.</span>
      </p>
      <p>
        <a href="https://github.com/urjaacharya/redgood">redgood</a>
        by
        <a
          href="https://www.urjaacharya.com/"
          aria-label="link to urja acharya site"
        >urja acharya</a>
      </p>
    </div>
    <div style="text-align: right; margin-bottom: 0.25em; font-size: 1.2em">
      <a class="primary-icon to-top" href="#" aria-label="navigate to top">
        <i class="bi bi-arrow-up-circle-fill"></i>
      </a>
    </div>
  </div>
</footer>
</body>
</html>
